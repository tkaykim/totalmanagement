# 댄서 정보 형식 변환 지시문

## 목적
사용자가 자유 형식으로 입력한 댄서 정보를 정해진 데이터베이스 입력 형식으로 자동 변환합니다.

## 입력 형식 (목표 형식)
```
닉네임(한글)	닉네임(영어)	본명	소속팀	소속사	국적	연락처	은행명	계좌번호;다음댄서정보...
```

- **댄서 구분**: 세미콜론(`;`)
- **필드 구분**: 탭(`\t`) 또는 쉼표(`,`)
- **필드 순서**: 닉네임(한글) | 닉네임(영어) | 본명 | 소속팀 | 소속사 | 국적 | 연락처 | 은행명 | 계좌번호
- **필수 필드**: 닉네임(한글), 닉네임(영어), 본명 중 최소 하나

## 변환 규칙

### 1. 댄서 구분 인식
다음 패턴들을 댄서 구분자로 인식:
- 명시적 세미콜론(`;`)
- 줄바꿈 후 새로운 댄서 정보 시작 (이름/닉네임으로 시작)
- "다음", "그 다음", "또", "그리고" 등의 연결어 뒤
- 번호나 불릿 포인트(`1.`, `2.`, `-`, `•`)

### 2. 필드 추출 규칙

#### 이름/닉네임 필드
- 한글 이름 → `nickname_ko` 또는 `real_name` (문맥 판단)
- 영문 이름 → `nickname_en`
- 괄호 안의 이름 → 별칭으로 처리
  - 예: "김철수(철이)" → nickname_ko: "철이", real_name: "김철수"
  - 예: "Lee (David)" → nickname_en: "David", real_name: "Lee"

#### 소속팀/소속사
- "팀", "팀명", "소속팀" 뒤의 값 → `team_name`
- "회사", "소속사", "기획사" 뒤의 값 → `company`
- "소속:" 뒤의 값 → 문맥에 따라 team_name 또는 company

#### 국적
- "국적:", "국적", "Nationality:" 뒤의 값 → `nationality`
- 국가명 직접 언급 (한국, 미국, 일본, 중국 등) → `nationality`
- 국기 이모지나 국가 코드도 인식 가능

#### 연락처
- 전화번호 패턴 (010-1234-5678, 01012345678, +82-10-1234-5678 등) → `contact`
- "연락처:", "전화:", "Phone:", "Tel:" 뒤의 값 → `contact`
- 이메일 주소 → `contact` (이메일 형식인 경우)

#### 은행 정보
- "은행:", "은행명:", "Bank:" 뒤의 값 → `bank_name`
- 은행명 직접 언급 (국민은행, 신한은행, 하나은행 등) → `bank_name`
- "계좌:", "계좌번호:", "Account:" 뒤의 값 → `account_number`
- 숫자만 있는 긴 문자열 (10자 이상) → `account_number` (은행명이 앞에 있는 경우)

### 3. 필드 매핑 우선순위

1. **명시적 라벨 우선**: "이름:", "닉네임:", "소속팀:" 등의 라벨이 있으면 해당 필드로 매핑
2. **위치 기반**: 라벨이 없으면 입력 순서나 위치로 판단
3. **패턴 기반**: 전화번호, 이메일, 계좌번호 등의 패턴으로 자동 인식
4. **문맥 기반**: 주변 텍스트의 의미로 판단

### 4. 데이터 정제 규칙

- 공백 제거: 앞뒤 공백 제거
- 특수문자 정리: 불필요한 괄호, 따옴표 제거 (단, 의미 있는 괄호는 보존)
- 빈 값 처리: 빈 문자열은 `undefined`로 변환
- 중복 제거: 동일한 정보가 여러 필드에 중복되면 우선순위에 따라 하나만 유지

## 변환 예시

### 예시 1: 자유 형식 입력
```
입력:
김철수, Kim, 본명: 김철수, 팀A, 회사A, 한국, 010-1234-5678, 국민은행, 123-456-789
이영희, Lee, 본명: 이영희, 팀B, 한국, 010-9876-5432
박민수, Park, 본명: 박민수, 회사C, 한국
```

```
출력:
김철수	Kim	김철수	팀A	회사A	한국	010-1234-5678	국민은행	123-456-789;이영희	Lee	이영희	팀B			한국	010-9876-5432		;박민수	Park	박민수		회사C	한국			
```

### 예시 2: 문장 형식 입력
```
입력:
1. 김철수 (닉네임: 철이), 영어명은 Kim입니다. 소속은 팀A이고 회사는 회사A입니다. 국적은 한국이며 연락처는 010-1234-5678입니다. 국민은행 계좌번호는 123-456-789입니다.
2. 이영희, Lee, 팀B 소속, 한국, 전화: 010-9876-5432
```

```
출력:
철이	Kim	김철수	팀A	회사A	한국	010-1234-5678	국민은행	123-456-789;이영희	Lee	이영희	팀B			한국	010-9876-5432		
```

### 예시 3: 표 형식 입력
```
입력:
이름 | 영어명 | 소속팀 | 국적 | 연락처
김철수 | Kim | 팀A | 한국 | 010-1234-5678
이영희 | Lee | 팀B | 한국 | 010-9876-5432
```

```
출력:
김철수	Kim			팀A			한국	010-1234-5678		;이영희	Lee			팀B			한국	010-9876-5432		
```

## 처리 지침

1. **유연한 파싱**: 다양한 입력 형식을 허용하고 최대한 정보를 추출
2. **오류 처리**: 
   - 필수 정보(이름)가 없으면 해당 댄서는 제외
   - 불확실한 정보는 빈 값으로 처리
3. **검증**: 
   - 변환 후 필수 필드(이름) 존재 여부 확인
   - 전화번호 형식 검증 (선택사항)
4. **피드백**: 변환된 결과를 사용자에게 보여주고 수정 기회 제공

## 구현 시 주의사항

- 정규표현식과 자연어 처리 기법을 조합하여 사용
- 사용자가 입력한 원본 형식을 최대한 보존하려 노력
- 모호한 경우 사용자에게 확인 요청
- 변환 실패 시 원본 텍스트를 그대로 반환하거나 에러 메시지 표시



